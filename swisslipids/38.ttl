prefix ex: <https://sparql.swisslipids.org/.well-known/sparql-examples/> 
prefix sh: <http://www.w3.org/ns/shacl#> 
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs:<http://www.w3.org/2000/01/rdf-schema#> 
ex:38
    a sh:SPARQLSelectExecutable, sh:SPARQLExecutable ;
    sh:prefixes ex: ;
    rdfs:label "Published lipids with the same components, positions" ;
    rdfs:comment """Returns the list of isomeric subspecies that contain the same fatty acid component(s) at the same position(s) as a user-defined lipid, but limits the output to published lipids linked to a PMID.
Output should include the corresponding SwissLipids ID(s) and name(s) and the PMID(s) for each.
ï¿¼Extends ex:36
Output should include the corresponding SwissLipids ID(s) and name(s)."""^^rdf:HTML ;
    sh:select """# Example 38
SELECT ?startId ?startName ?tail1 ?tailName1 ?tail2 ?tailName2 ?id ?name ?pubmed
WHERE {
  VALUES ?startId { SLM:000121946 }
  ?startId rdfs:label ?startName .
  # tail components
  ?startId SLM:haspart ?tail1 .
  ?startId SLM:haspart ?tail2 .
  FILTER(!sameTerm(?tail1, ?tail2))
  ?tail1 rdfs:label ?tailName1 .
  ?tail2 rdfs:label ?tailName2 .

  # Retrieve lipids with similar tails
  ?id SLM:haspart ?tail1 , 
                  ?tail2 .
  
  # Restrict to isomeric subspecies with PubMed citation(s)
  ?id SLM:rank SLM:Isomeric_Subspecies .
  ?id SLM:citation ?pubmed .

  # Retrieve name
  ?id rdfs:label ?name .
}
ORDER BY ?id ?tail1 ?tail2
""" .
